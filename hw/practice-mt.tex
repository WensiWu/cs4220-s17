\documentclass[12pt, leqno]{article}
\input{common}


\begin{document} \hdr{Practice midterm}{Never!}

For the midterm, you are allowed to use texts, papers, or other
references (with citation).  You should not ask help from any other
person, whether inside or outside the class.  You should not worry if
you do not get all the answers; this is a sign that the test is doing
a proper job!  We reserve the right to ask follow-up questions in
person (e.g.~to determine whether it makes sense to assign partial
credit).  You may ask us to clarify ambiguities or perceived errors in
the prompt, but please do not ask for hints.

For the practice, of course, you can ask whatever you want!
Bring questions to Friday lecture if there are problems you consider
particularly vexing.

\begin{enumerate}

\item
  Given the described factorization, write a short {\em efficient}
  MATLAB expression to evaluate each of the following
  \begin{enumerate}
    
  \item Given \verb|[L,U,P] = lu(A)|, solve $Ax = b$.

  \item Given \verb|[U,S,V] = svd(A,0); sigma = diag(S);| \\
    minimize $\|Ax-b\|^2 + \lambda \|x\|^2$.

  \item Given a \verb|[Q,R] = qr(A)| where $A$ is square and
    nonsingular, find the $j$th diagonal element of $A^{-1}$.
    
  \end{enumerate}

\item
  Write a line of MATLAB to compute $y = \cos(x)-1$ accurately in floating
  point for $x \in [-0.5, 0.5]$.  Your code should not lose accuracy
  for $|x| \ll 1$.

\item
  In class, we sketched a factorization based approach to solving the
  least squares problem of minimizing $\|Ax-b\|_M^2$.  Given the
  required factorizations, give a simple expression for the derivative
  of $x$ with respect to a given small perturbations in $M$ (call it
  {\tt dM} in MATLAB).

\item
  Rewrite the following function to run in $O(n)$ time:
\begin{verbatim}
function [y] = triuLR(u, v, x)
y = triu(u*v')*x;
\end{verbatim}

\item
  Suppose $T$ is a symmetric tridiagonal matrix with diagonal entries
  $\alpha_1, \ldots, \alpha_n$ and off-diagonal entries $\beta_1,
  \ldots, \beta_n$.  Without using MATLAB sparse matrices, write an
  $O(n)$ code that works directly with the coefficient vectors to
  check whether $T$ is positive definite:
\begin{verbatim}
function [p] = check_pd(alpha, beta)
% Return p = 0 if the T is positive definite, p > 0 otherwise
\end{verbatim}
  
\item
  Let $\alpha \in \bbR^+$ and $u \in \bbR^n$ be given.
  Rewrite the following MATLAB function to run in $O(n)$ time
\begin{verbatim}
function d = choldiag(alpha, u)
n = length(alpha);
d = diag(chol(eye(n) + alpha*u*u'));
\end{verbatim}

\end{enumerate}

\end{document}
